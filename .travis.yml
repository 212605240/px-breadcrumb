sudo: required
dist: trusty
language: node_js
node_js:
- stable
branches:
  except:
  - gh-pages
addons:
  firefox: latest
  apt:
    sources:
    - google-chrome
    packages:
    - google-chrome-stable
before_script:
- npm install web-component-tester@^5.0.0
- npm install bower
- export PATH=$PWD/node_modules/.bin:$PATH
- bower install
script:
- xvfb-run wct --skip-plugin sauce
- if [ "${TRAVIS_PULL_REQUEST}" = "false" ]; then wct --plugin sauce --skip-plugin
  local; fi
env:
  global:
  - secure: CZwvNpBLxr0aHDgKaRE2/em7hZz7aUEhwsP+Xc0PS685AmF5/Orf6LLuYyLBN3mhZkO7IyYYvU3ulVu5rZ57QMyB/usz9eQcjRuUkAfK/lZqdJW9g/zZpbxtWSjFIiksWSInXdiSZhcEudsQPwlAClslbgjLW+A2OZILEOCiaC5s/26RfS4RBPKGb4kA/g0X54AziMz+96uP2kD1Vpw8vkW612flhlka6teJxs+yl/wXaOffRW6Nbq4ut3xzAQ1ieWVBmExYhyOcAXQC0XgOwBnSIpLk+R0McSVz/X0LTWHBlsxCNf5vifURiJ7ZFsLmMXvg59qHomMf0IOiuhG6Qs8Fxt1398Bhjw5YPaKyibUqGwL550coLP1JYCZEvite/qQihO8OePkA8P5jU+YOIJGaPoWWlazakD4SZlAo3csm7CMPVusJfTKq4F7MeJ7Y40paEUE8ZOzt3WIXAfHgCBBVHMZYcuhJuo0UU5ySC6pScv4TBQGqkpzrnHer8O0zQcgqmirsXUY/rlYdY2Tfc3L50QSc5hacxja8nr1bFkCzGCxxbk1HVYO53tCqKgvWSsYVI2zWr7WT8M8hMauB2Thng36V2YoruoTbtyaQU9hn4BohBdCIl6avAoKc7YSneLCYcCn3k4jU/Wna/dO6isHZ5uGLQCMofX5JSgbsH24=

after_success:
- if [ "${TRAVIS_PULL_REQUEST}" = "false" ]; then openssl aes-256-cbc -k "$DEPLOYSECRET"
  -in deploy.enc -out deploy_key -d; fi
- cd $TRAVIS_BUILD_DIR/scripts
- chmod 755 ghp.sh
- "./ghp.sh"
